{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nlet raiseEmptySearchCriteria = () => {\n    iziToast.show({\n        message: `Fill search field`,\n        position: \"topRight\",\n        backgroundColor: 'rgb(250,128,114)',\n        messageColor: 'rgb(255,255,255)'\n    });\n}\n\nlet raiseEmptyResponse = () => {\n    iziToast.show({\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        position: \"topRight\",\n        backgroundColor: 'rgb(250,128,114)',\n        messageColor: 'rgb(255,255,255)'\n    });\n}\n\nexport function raiseReachedEnd() {\n    iziToast.show({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: \"topRight\",\n        backgroundColor: 'rgb(250,128,114)',\n        messageColor: 'rgb(255,255,255)'\n    });\n}\n\nexport async function loadData(searchText, callbackOnSuccess, callbackOnError, callOnFinally, currentPage = 1) {\n    if (searchText === null || searchText.trim() === \"\") {\n        raiseEmptySearchCriteria();\n        callOnFinally();\n        return;\n    }\n\n    try {\n        let response = await axios({\n            method: 'get',\n            url: 'https://pixabay.com/api/?',\n            params: {\n                key: '45339856-2e70ead6ce9cf82bdbbd89c7e',\n                q: searchText,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: 15,\n                page: currentPage\n            }\n        });\n\n        if (response.data.hits.length > 0) {\n            callbackOnSuccess(response.data);\n        } else {\n            raiseEmptyResponse();\n        }\n\n    } catch (error) {\n        callbackOnError(error)\n    } finally {\n        callOnFinally();\n    }\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\"\n\nlet box = new SimpleLightbox('ul.results a', { captionsData: 'alt', captionDelay: 250 });\n\nfunction getElement(element) {\n  return `<li class=\"result-item\">\n        <a class=\"result-link\"\n          href=\"${element.largeImageURL}\">\n          <img class=\"result-image\"\n            src=\"${element.webformatURL}\"\n            alt=\"${element.tags}\" />\n          <ul class=\"statistic\">\n            <li class=\"statistic-item\">\n              <span class=\"likes-title\">Likes</span>\n              <span class=\"likes-number\">${element.likes}</span>\n            </li>\n            <li class=\"statistic-item\">\n              <span class=\"likes-title\">Views</span>\n              <span class=\"likes-number\">${element.views}</span>\n            </li>\n            <li class=\"statistic-item\">\n              <span class=\"likes-title\">Comments</span>\n              <span class=\"likes-number\">${element.comments}</span>\n            </li>\n            <li class=\"statistic-item\">\n              <span class=\"likes-title\">Downloads</span>\n              <span class=\"likes-number\">${element.downloads}</span>\n            </li>\n          </ul>\n        </a>\n      </li>`\n}\n\nexport function render(arrayOfElements) {\n  const update = arrayOfElements.map(el => getElement(el)).join(\"\");\n  \n  const gallery = document.querySelector(\"ul.results\");\n  gallery.insertAdjacentHTML(\"beforeend\", update);\n\n  box.refresh();\n}","import { loadData, raiseReachedEnd } from './js/pixabay-api';\nimport { render } from './js/render-functions';\n\nconst mainForm = document.querySelector('.search');\n\nlet loader = document.querySelector('div.loader-panel');\nlet loadMoreBtn = document.querySelector('.load-more');\n\nloader.style.display = 'none';\nhideLoadMoreButton();\n\nlet currentPage = 1;\n\nfunction showOrHideLoadMoreButton(loaded) {\n  if (loaded.totalHits > currentPage * 15) {\n    loadMoreBtn.style.display = 'block';\n  } else {\n    hideLoadMoreButton();\n    raiseReachedEnd();\n  }\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreBtn.style.display = 'none';\n}\n\nfunction scrollPage() {\n  let element = document.querySelector('.result-item');\n  let elementHeight = element.getBoundingClientRect()['height'];\n  window.scrollBy({\n    top: elementHeight * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nmainForm.addEventListener('submit', event => {\n  hideLoadMoreButton();\n  event.preventDefault();\n  loader.style.display = 'block';\n  const oldElements = document.querySelectorAll('li.result-item');\n  const searchQuery = mainForm.elements['search-query'].value;\n  if (oldElements && oldElements.length > 0) {\n    oldElements.forEach(element => element.remove());\n  }\n\n  currentPage = 1;\n\n  loadData(\n    searchQuery,\n    response => {\n      render(response.hits);\n      showOrHideLoadMoreButton(response);\n    },\n    error => console.error(error),\n    () => (loader.style.display = 'none'),\n    currentPage\n  );\n});\n\nloadMoreBtn.addEventListener('click', event => {\n  hideLoadMoreButton();\n  currentPage += 1;\n  const searchQuery = mainForm.elements['search-query'].value;\n  loadData(\n    searchQuery,\n    response => {\n      render(response.hits);\n      showOrHideLoadMoreButton(response);\n      scrollPage();\n    },\n    error => console.error(error),\n    () => (loader.style.display = 'none'),\n    currentPage\n  );\n});\n"],"names":["raiseEmptySearchCriteria","iziToast","raiseEmptyResponse","raiseReachedEnd","loadData","searchText","callbackOnSuccess","callbackOnError","callOnFinally","currentPage","response","axios","error","box","SimpleLightbox","getElement","element","render","arrayOfElements","update","el","mainForm","loader","loadMoreBtn","hideLoadMoreButton","showOrHideLoadMoreButton","loaded","scrollPage","elementHeight","event","oldElements","searchQuery"],"mappings":"owBAIA,IAAIA,EAA2B,IAAM,CACjCC,EAAS,KAAK,CACV,QAAS,oBACT,SAAU,WACV,gBAAiB,mBACjB,aAAc,kBACtB,CAAK,CACL,EAEIC,EAAqB,IAAM,CAC3BD,EAAS,KAAK,CACV,QAAS,2EACT,SAAU,WACV,gBAAiB,mBACjB,aAAc,kBACtB,CAAK,CACL,EAEO,SAASE,GAAkB,CAC9BF,EAAS,KAAK,CACV,QAAS,6DACT,SAAU,WACV,gBAAiB,mBACjB,aAAc,kBACtB,CAAK,CACL,CAEO,eAAeG,EAASC,EAAYC,EAAmBC,EAAiBC,EAAeC,EAAc,EAAG,CAC3G,GAAIJ,IAAe,MAAQA,EAAW,KAAI,IAAO,GAAI,CACjDL,IACAQ,IACA,MACH,CAED,GAAI,CACA,IAAIE,EAAW,MAAMC,EAAM,CACvB,OAAQ,MACR,IAAK,4BACL,OAAQ,CACJ,IAAK,qCACL,EAAGN,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMI,CACT,CACb,CAAS,EAEGC,EAAS,KAAK,KAAK,OAAS,EAC5BJ,EAAkBI,EAAS,IAAI,EAE/BR,GAGP,OAAQU,EAAO,CACZL,EAAgBK,CAAK,CAC7B,QAAc,CACNJ,GACH,CACL,CC7DA,IAAIK,EAAM,IAAIC,EAAe,eAAgB,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,EAEvF,SAASC,EAAWC,EAAS,CAC3B,MAAO;AAAA;AAAA,kBAESA,EAAQ,aAAa;AAAA;AAAA,mBAEpBA,EAAQ,YAAY;AAAA,mBACpBA,EAAQ,IAAI;AAAA;AAAA;AAAA;AAAA,2CAIYA,EAAQ,KAAK;AAAA;AAAA;AAAA;AAAA,2CAIbA,EAAQ,KAAK;AAAA;AAAA;AAAA;AAAA,2CAIbA,EAAQ,QAAQ;AAAA;AAAA;AAAA;AAAA,2CAIhBA,EAAQ,SAAS;AAAA;AAAA;AAAA;AAAA,YAK5D,CAEO,SAASC,EAAOC,EAAiB,CACtC,MAAMC,EAASD,EAAgB,IAAIE,GAAML,EAAWK,CAAE,CAAC,EAAE,KAAK,EAAE,EAEhD,SAAS,cAAc,YAAY,EAC3C,mBAAmB,YAAaD,CAAM,EAE9CN,EAAI,QAAO,CACb,CCtCA,MAAMQ,EAAW,SAAS,cAAc,SAAS,EAEjD,IAAIC,EAAS,SAAS,cAAc,kBAAkB,EAClDC,EAAc,SAAS,cAAc,YAAY,EAErDD,EAAO,MAAM,QAAU,OACvBE,IAEA,IAAIf,EAAc,EAElB,SAASgB,EAAyBC,EAAQ,CACpCA,EAAO,UAAYjB,EAAc,GACnCc,EAAY,MAAM,QAAU,SAE5BC,IACArB,IAEJ,CAEA,SAASqB,GAAqB,CAC5BD,EAAY,MAAM,QAAU,MAC9B,CAEA,SAASI,GAAa,CAEpB,IAAIC,EADU,SAAS,cAAc,cAAc,EACvB,sBAAuB,EAAC,OACpD,OAAO,SAAS,CACd,IAAKA,EAAgB,EACrB,KAAM,EACN,SAAU,QACd,CAAG,CACH,CAEAP,EAAS,iBAAiB,SAAUQ,GAAS,CAC3CL,IACAK,EAAM,eAAc,EACpBP,EAAO,MAAM,QAAU,QACvB,MAAMQ,EAAc,SAAS,iBAAiB,gBAAgB,EACxDC,EAAcV,EAAS,SAAS,cAAc,EAAE,MAClDS,GAAeA,EAAY,OAAS,GACtCA,EAAY,QAAQd,GAAWA,EAAQ,OAAQ,CAAA,EAGjDP,EAAc,EAEdL,EACE2B,EACArB,GAAY,CACVO,EAAOP,EAAS,IAAI,EACpBe,EAAyBf,CAAQ,CAClC,EACDE,GAAS,QAAQ,MAAMA,CAAK,EAC5B,IAAOU,EAAO,MAAM,QAAU,OAC9Bb,CACJ,CACA,CAAC,EAEDc,EAAY,iBAAiB,QAASM,GAAS,CAC7CL,IACAf,GAAe,EACf,MAAMsB,EAAcV,EAAS,SAAS,cAAc,EAAE,MACtDjB,EACE2B,EACArB,GAAY,CACVO,EAAOP,EAAS,IAAI,EACpBe,EAAyBf,CAAQ,EACjCiB,GACD,EACDf,GAAS,QAAQ,MAAMA,CAAK,EAC5B,IAAOU,EAAO,MAAM,QAAU,OAC9Bb,CACJ,CACA,CAAC"}